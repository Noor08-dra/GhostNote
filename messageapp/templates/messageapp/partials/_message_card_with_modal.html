<div class="col-md-4 mb-4">
  <a href="#" class="text-decoration-none text-white">
    <div class="card shadow-md message-body">
      {% if user.is_authenticated %}
        <div class="card-header d-flex justify-content-end gap-2">
        <a
          href="{% url 'message_edit' msg.pk %}"
          class="btn btn-light btn-sm rounded-pill"
          title="Edit message"
        >
          Edit
        </a>

        <button
          type="button"
          class="btn btn-light btn-sm rounded-pill"
          title="Delete message"
          data-bs-toggle="modal"
          data-bs-target="#deleteMsgModal{{msg.pk}}"
        >
          Delete
        </button>
      </div>
      {% endif %}
      <div class="card-body">
        <h4>Sent to : {{ msg.recipient_name }}</h4>

        <p>{{ msg.msg_text|linebreaksbr }}</p>

        <small> {{ msg.date_posted|timesince}} ago </small>
      </div>
    </div>
  </a>

  <div
    class="modal fade"
    id="deleteMsgModal{{ msg.pk }}"
    tabindex="-1"
    aria-labelledby="deleteModalLabel{{ msg.pk }}"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-white">
        <div class="modal-body p-4 text-center">
          <h3 class="modal-title mb-3" id="deleteModalLabel{{ msg.pk }}">
            Confirm Deletion
          </h3>
          <p class="text-white-50 mb-4">
            Are you sure you want to permanently delete the message to "{{msg.recipient_name }}"?
          </p>
          <form method="post" action="{% url 'delete_msg' msg.pk %}">
            {% csrf_token %}
            <div class="d-flex justify-content-center gap-3">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cancel
              </button>
              <button type="submit" class="btn btn-danger">Delete</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
